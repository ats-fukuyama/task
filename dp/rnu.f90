! rnu.f90

PROGRAM rnu
  USE bpsd
  IMPLICIT NONE
  REAL(rkind):: PTE,PNE,PA,PZ,PTI,PNI,PPN0,PTN0,PNE_temp
  REAL(rkind):: RLAMEE,RLAMEI,RLAMII,VTE,VTI,SN,PNN0
  REAL(rkind):: RNUEE,RNUEI,RNUEN,RNUE,RNUIE,RNUII,RNUIN,RNUI

  PTE=0.01D0
  PNE=1.D-3
  PA=39.D0
  PZ=1.D0
  PTI=0.01D0
  PPN0=0.5D0
  PTN0=0.025D0

1 WRITE(6,*)
  WRITE(6,'(A,1P3E12.4)') 'PNE,PTE,PTI   [keV]=',PNE,PTE,PTI
  WRITE(6,'(A,1P4E12.4)') 'PA,PZ,PPN0,PTN0[eV]=',PA,PZ,PPN0,PTN0
  WRITE(6,'(A)') '## INPUT : PNE,PTE,PTI,PA,PZ,PPN0,PTN0'
  PNE_temp=PNE
  READ(5,*,ERR=1,END=9) PNE_temp,PTE,PTI,PA,PZ,PPN0,PTN0
  IF(PNE_temp.LE.0.D0) GOTO 9
  PNE=PNE_temp
  PNI=PNE/PZ
  
  RLAMEE= 8.0D0+2.3D0*(LOG10(PTE*1.D3)-0.5D0*LOG10(PNE))
  RLAMEI= RLAMEE+0.3D0
  RLAMII=12.1D0+2.3D0*(LOG10(PTI*1.D3)-0.5D0*LOG10(PNE))

  SN=1.D-20 ! tytpical ionizatioin crosssection
  PNN0=PPN0/(PTN0*AEE) ! neutral density

  VTE=SQRT(2.D3*PTE*AEE/AME)
  RNUEE=PNE*RLAMEE/(1.24D-4*SQRT(PTE)**3)
  RNUEI=PNI*RLAMEI/(1.51D-4*SQRT(PTE)**3)
  RNUEN=PNN0*SN*0.88D0*VTE
  RNUE=RNUEE+RNUEI+RNUEN

  VTI=SQRT(2.D3*PTI*AEE/(PA*AMP))
  RNUIE=PZ**2*PNE*RLAMEI &
       /(2.00D-1*SQRT(PTE)**3*PA)
  RNUII=PNI*RLAMII &
       /(5.31D-3*SQRT(PTI)**3*SQRT(PA))
  RNUIN=PNN0*SN*0.88D0*VTI
  RNUI=RNUIE+RNUII+RNUIN

  WRITE(6,'(A,1P5E12.4)') 'PNE,PTE,PP/PT/PNN0=',PNE,PTE,PPN0,PTN0,PNN0
  WRITE(6,'(A,1P4E12.4)') 'PNI,PTI,PA,PZ     =',PNI,PTI,PA,PZ
  WRITE(6,'(A,1P5E12.4)') 'RNUEE/I/N/TOT/Hz  =', &
       RNUEE,RNUEI,RNUEN,RNUE,RNUE/(2.D0*PI)
  WRITE(6,'(A,1P5E12.4)') 'RNUIE/I/N/TOT/Hz  =', &
       RNUIE,RNUII,RNUIN,RNUI,RNUI/(2.D0*PI)
  GOTO 1

9 CONTINUE
  STOP
END PROGRAM rnu
  
