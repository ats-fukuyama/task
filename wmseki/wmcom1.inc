C
      COMMON /WMPRL1/ PNA,PNAL,PTA,ZEFF
      COMMON /WMPRL2/ NRMAX,NTHMAX,NPHMAX
      COMMON /WMPRL3/ NTH0,NPH0,NHC,NHCF
      COMMON /WMPRL4/ NPRINT,NGRAPH,NCONT
      COMMON /WMPRL5/ MODELJ,MODELA,MODELK,MODELM,MODELW,MODELPH
      COMMON /WMPRL6/ PRFIN,NSUMAX,NSWMAX
      COMMON /WMPRL7/ MODELPR(NRM,NSM),MODELVR(NRM,NSM)
      COMMON /WMPRL8/ PFRACL(NPHM),NPH0L(NPHM)
      COMMON /WMPRL9/ MDMAX_IPS,NDMAX_IPS
C    seki
      COMMON /WMVWOUT/ B0_FACT
C
      COMMON /WMANT1/ CRF,RD,BETAJ,MWGMAX
      COMMON /WMANT2/ AJ(NAM),APH(NAM),AEWGT(NAM),AEWGZ(NAM),NAMAX
      COMMON /WMANT3/ THJ1(NAM),THJ2(NAM),PHJ1(NAM),PHJ2(NAM)
      COMMON /WMANT4/ ANTANG(NAM)

C  --- internarl variables ---

      COMMON /WMPRX20/ NHHMAX,NHGMAX
      COMMON /WMPRX21/ NTHMAX_F,NHHMAX_F
      COMMON /WMPRX22/ NTHMAX_SV, NHHMAX_SV,NPHMAX_SV
      COMMON /WMPRX23/ NTHMAX_IPS_F,NHHMAX_IPS_F
      COMMON /WMPRX31/ NPH0_SV
      COMMON /WMPRX9/  NR_S
C
      COMMON /WMNOD1/ XR(NRM),XRHO(NRM)
      COMMON /WMNOD2/ MDSIZ,MDMIN,MDMAX,LDSIZ,LDMIN,LDMAX,MDSIZX
      COMMON /WMNOD21/ MDSIZ_F,MDMIN_F,MDMAX_F,LDSIZ_F
      COMMON /WMNOD22/ LDMIN_F,LDMAX_F,MDSIZX_F
      COMMON /WMNOD223/ LDMIN_IPS_F,LDMAX_IPS_F,LDSIZ_IPS_F
      COMMON /WMNOD3/ NDSIZ,NDMIN,NDMAX,KDSIZ,KDMIN,KDMAX,NDSIZX
      COMMON /WMNOD31/ NDSIZ_F,NDMIN_F,NDMAX_F,KDSIZ_F
      COMMON /WMNOD32/ KDMIN_F,KDMAX_F,NDSIZX_F
      COMMON /WMNOD323/ KDMIN_IPS_F,KDMAX_IPS_F,KDSIZ_IPS_F
      COMMON /WMNOD33/ NDMMIN,NDMMAX,KDMMIN,KDMMAX
      COMMON /WMNOD33/ NDMSIZ,KDMSIZ
      COMMON /WMNOD33/ MDMSIZ,LDMSIZ
      COMMON /WMNOD4/ CJANT(3,MDM,NDM),MODEWG
      COMMON /WMNOD5/ CEWALL(MDM,NDM,3)
C
      COMMON /WMMTX1/ MLEN,MBND,istart,iend,NBSIZ
      COMMON /WMMTX2/ CFVG(MLENM)
      COMMON /WMMTX3/ NBST,NBED,NRST,NRED
      COMMON /WMMTX4/ NBMODE
C
      COMMON /WMTNS1/ CTNSR(3,3,-MDMXF:MDMXF,-NDMXF:NDMXF,MDMF,NDMF)
      COMMON /WMTNS11/ CTNSR_1(3,3,MDMIPSF,NDMIPSF)
      COMMON /WMTNS2/ CGD(3,3,MDMF,MDM,NDMF,NDM,3)
      COMMON /WMTNSH2/ CGDH(3,3,MDMF,MDM,NDMF,NDM,3)
      COMMON /WMTNSD2/ CGDD(3,3,MDMF,MDM,NDMF,NDM,3)
      COMMON /WMTNSDH2/ CGDDH(3,3,MDMF,MDM,NDMF,NDM,3)
      COMMON /WMTNS3/ CPSF(3,3,MDMF,MDM,NDMF,NDM,3)
      COMMON /WMTNSH3/ CPSHF(3,3,MDMF,MDM,NDMF,NDM,3)
C
      COMMON /WMEQG1/ RG11(MDMF,NDMF,NRM),RG12(MDMF,NDMF,NRM)
      COMMON /WMEQG2/ RG13(MDMF,NDMF,NRM),RG22(MDMF,NDMF,NRM)
      COMMON /WMEQG3/ RG23(MDMF,NDMF,NRM),RG33(MDMF,NDMF,NRM)
C
      COMMON /WMEQG4/ RGU11(MDMF,NDMF,NRM),RGU12(MDMF,NDMF,NRM)
      COMMON /WMEQG5/ RGU13(MDMF,NDMF,NRM),RGU22(MDMF,NDMF,NRM)
      COMMON /WMEQG6/ RGU23(MDMF,NDMF,NRM),RGU33(MDMF,NDMF,NRM)
C
      COMMON /WMEQG11/ RG11_IPS(MDMIPSF,NDMIPSF,NRM)
      COMMON /WMEQG12/ RG12_IPS(MDMIPSF,NDMIPSF,NRM)
      COMMON /WMEQG13/ RG13_IPS(MDMIPSF,NDMIPSF,NRM)
      COMMON /WMEQG14/ RG22_IPS(MDMIPSF,NDMIPSF,NRM)
      COMMON /WMEQG15/ RG23_IPS(MDMIPSF,NDMIPSF,NRM)
      COMMON /WMEQG16/ RG33_IPS(MDMIPSF,NDMIPSF,NRM)
C
      COMMON /WMEQG4/ RJ(MDMF,NDMF,NRM)
      COMMON /WMEQG5/ CGF11(MDMF,NDMF,3),CGF12(MDMF,NDMF,3)
      COMMON /WMEQG6/ CGF13(MDMF,NDMF,3),CGF22(MDMF,NDMF,3)
      COMMON /WMEQG7/ CGF23(MDMF,NDMF,3),CGF33(MDMF,NDMF,3)
      COMMON /WMEQG8/ CMAF(3,3,MDMF,NDMF,3)
      COMMON /WMEQG9/ CRMAF(3,3,MDMF,NDMF,3)
C
      COMMON /WMEQGH1/ RGH11(MDMF,NDMF,NRM),RGH12(MDMF,NDMF,NRM)
      COMMON /WMEQGH2/ RGH13(MDMF,NDMF,NRM),RGH22(MDMF,NDMF,NRM)
      COMMON /WMEQGH3/ RGH23(MDMF,NDMF,NRM),RGH33(MDMF,NDMF,NRM)
      COMMON /WMEQGH4/ RJH(MDMF,NDMF,NRM)
      COMMON /WMEQGH5/ CGHF11(MDMF,NDMF,3),CGHF12(MDMF,NDMF,3)
      COMMON /WMEQGH6/ CGHF13(MDMF,NDMF,3),CGHF22(MDMF,NDMF,3)
      COMMON /WMEQGH7/ CGHF23(MDMF,NDMF,3),CGHF33(MDMF,NDMF,3)
      COMMON /WMEQGH8/ CMAHF(3,3,MDMF,NDMF,3)
      COMMON /WMEQGH18/ CRMAHF(3,3,MDMF,NDMF,3)
C
      COMMON /WMFLD10/ CEFLD(3,MDM,NDM,NRM),CEFLDK(3,MDM,NDM,NRM)
      COMMON /WMFLD11/ CEFLD3D(3,MDM,NPHM,NRM),CEFLD3DK(3,MDM,NPHM,NRM)
      COMMON /WMFLD21/ CEFLDD(3,MDM,NDM,NRM)
      COMMON /WMFLD20/ CBFLD(3,MDM,NDM,NRM),CBFLDK(3,MDM,NDM,NRM)
      COMMON /WMFLD11/ CBFLD3D(3,MDM,NPHM,NRM),CBFLD3DK(3,MDM,NPHM,NRM)
      COMMON /WMFLD22/ CBFLDD(3,MDM,NDM,NRM)
      COMMON /WMFLD30/ CEN(3,MDM,NDM,NRM),CEP(3,MDM,NDM,NRM)
      COMMON /WMFLD23/ CEND(3,MDM,NDM,NRM),CEPD(3,MDM,NDM,NRM)
      COMMON /WMFLD40/ CBN(3,MDM,NDM,NRM),CBP(3,MDM,NDM,NRM)
C
      COMMON  /WMPWR1/ PABS(MDM,NDM,NRM,NSM),PABSK(MDM,NDM,NRM,NSM)
      COMMON /WMPWR21/ PABSD(MDM,NDM,NRM,NSM),PABSKF(MDM,NPHM,NRM,NSM)
      COMMON  /WMPWR2/ PABSR(NRM,NSM),PABSKT(MDM,NDM,NSM)
      COMMON /WMPWR22/ PABSDR(NRM,NSM),PABSKFT(MDM,NPHM,NSM)
      COMMON  /WMPWR3/ CFLX(MDM,NDM,NRM),CFLXK(MDM,NDM,NRM),CFLXR(NRM)
      COMMON  /WMPWR4/ CRADK(MDM,NDM,NAM),CRADKT(MDM,NDM)
      COMMON  /WMPWR5/ CRADT(NAM),CRADTT,PABST(NSM),PABSTT
      COMMON /WMPWR25/ CRADDT(NAM),CRADDTT,PABSDT(NSM),PABSDTT
      COMMON /WMPWR35/ CRADFT(NAM,NHCM),CRADFTT(NHCM)
      COMMON /WMPWR45/ PABSFT(NSM,NHCM),PABSFTT(NHCM)
       COMMON /WMPWR6/ PCUR(MDM,NDM,NRM),PCURR(NRM),PCURT
      COMMON /WMPWR26/ PCURD(MDM,NDM,NRM),PCURDR(NRM),PCURDT
       COMMON /WMPWR7/ CPABSK(MDM,NDM,NRM,NSM)
      COMMON /WMPWR17/ CPABS3D(MDM,NPHM,NRM,NSM)
      COMMON /WMPWR27/ CPABS3DK(MDM,NPHM,NRM,NSM)
       COMMON /WMPWR8/ CPABS(MDM,NDM,NRM,NSM)
      COMMON /WMPWR28/ CPABSD(MDM,NDM,NRM,NSM)
      COMMON /WMPWRB/ PABST3D(NPHM,NSM),PABSTT3D(NPHM)
      COMMON /WMPWRC/ PABS3D(MDM,NPHM,NRM,NSM)
C
      COMMON /WMEQX1/ RPST(NTHMF,NHHMF,NRM),ZPST(NTHMF,NHHMF,NRM)
      COMMON /WMEQX2/ PPST(NTHMF,NHHMF,NRM),BPST(NTHMF,NHHMF,NRM)
      COMMON /WMEQX3/ BFLD(2:3,NTHMF,NHHMF,NRM)
      COMMON /WMEQX11/ RPST_IPS(NTHMIPSF,NHHMIPSF,NRM)
      COMMON /WMEQX12/ ZPST_IPS(NTHMIPSF,NHHMIPSF,NRM)
      COMMON /WMEQX13/ PPST_IPS(NTHMIPSF,NHHMIPSF,NRM)
      COMMON /WMEQX14/ BPST_IPS(NTHMIPSF,NHHMIPSF,NRM)
      COMMON /WMEQX15/ BFLD_IPS(2:3,NTHMIPSF,NHHMIPSF,NRM)
      COMMON /WMEQX4/ RGMIN,RGMAX,ZGMIN,ZGMAX
      COMMON /WMEQX5/ RSU(NSUM,NDM),ZSU(NSUM,NDM)
      COMMON /WMEQX6/ RSW(NSUM,NDM),ZSW(NSUM,NDM)
C
      COMMON /WMEQU1/ RHOT(NRM),PSIP(NRM),PSIPA,PSITA
      COMMON /WMEQU2/ RPS(NTHMF,NRM),ZPS(NTHMF,NRM)
      COMMON /WMEQU4/ DRPSI(NTHMF,NRM),DZPSI(NTHMF,NRM)
      COMMON /WMEQU5/ DRCHI(NTHMF,NRM),DZCHI(NTHMF,NRM)
      COMMON /WMEQU12/ RPS_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU13/ ZPS_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU14/ DRPSI_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU15/ DZPSI_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU16/ DRCHI_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU17/ DZCHI_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU6/ PPS(NRM),QPS(NRM),RBPS(NRM),VPS(NRM),RLEN(NRM)
      COMMON /WMEQU7/ BPR(NTHMF,NRM),BPZ(NTHMF,NRM)
      COMMON /WMEQU8/ BPT(NTHMF,NRM),BTP(NTHMF,NRM)
      COMMON /WMEQU27/  BPR_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU28/  BPZ_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU29/  BPT_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU210/ BTP_IPS(NTHMIPSF,NRM)
      COMMON /WMEQU9/ SIOTA(NRM)
C
      COMMON /EQPRM/ RAXIS,ZAXIS
C
      COMMON /WMFFT1/ CT(MDMIPSF*2),RFFT(MDMIPSF*2),LFFT(MDMIPSF*2)
C
      COMMON /WMEGN1/ FRMIN,FRMAX,FIMIN,FIMAX,FI0
      COMMON /WMEGN2/ FRINI,FIINI
      COMMON /WMEGN3/ NGFMAX,NGXMAX,NGYMAX
      COMMON /WMEGN4/ SCMIN,SCMAX,NSCMAX
      COMMON /WMEGN5/ LISTEG
      COMMON /WMEGN6/ DLTNW,EPSNW,LMAXNW,LISTNW,MODENW
C
      COMMON /WMTAE1/ WAEMIN,WAEMAX
C
      COMMON /WMPRF1/ RNPRF(NRM,NSM),RTPRF(NRM,NSM)
C
      COMMON /WMEGP1/ AMPEIGEN,MODEEG
C
      COMMON /WMGRA1/ KACONT(8,NRGM,NTHGM)
      COMMON /WMGRA2/ RPSG(NTHGM,NRM),ZPSG(NTHGM,NRM)
C
      COMMON /WMNAM1/ KNAMEQ_SAVE
      CHARACTER KNAMEQ_SAVE*80
      COMMON /WMNAM2/ KNAMTR_SAVE
      CHARACTER KNAMTR_SAVE*80
      COMMON /WMNAM3/ KNAMWM_SAVE
      CHARACTER KNAMWM_SAVE*80
C
      COMMON /WMXPR1/ PN60(NRM,NSM), PT60(NRM,NSM)

      COMMON /WMKPARA/ PARAk(MDM,NDM,NRM)
