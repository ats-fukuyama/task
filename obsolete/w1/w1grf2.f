C
C     ****** TASK/W1 (SUBROUTINE LIBRARY 1) ******
C
C     ****** 1-D GRAPHIC ROUTINE (HELICITY) ******
C
C     ****** 1-D GRAPHIC ROUTINE (B AND A) ******
C
      SUBROUTINE W1GR1B(NGRAPH)
C
      IMPLICIT COMPLEX*16(C),REAL*8(A-B,D-H,O-Z)
C
      INCLUDE 'w1comm.f'
      PARAMETER (NZPM=2**NZLM)
      PARAMETER (NXTM=NXPM+2*NXVM,NXM=NXPM*6+10,NXQ=NXPM+1)
      COMMON /W1PRM1/ NXP,NXV,NXT,ISMAX,IAMAX
      COMMON /W1PRM2/ RF,RKZ,BB,RR,RA,RD,RB,WALLR
      COMMON /W1CNST/ AEE,AME,AMM,VC,EPS0,AMYU0,PI
      COMMON /W1BAH1/ CEF(NXTM,3),CBF(NXTM,3),CAF(NXTM,4)
      COMMON /W1PWR1/ PABSX(NXPM,ISM),FLUXX(NXTM),PABSXZ(ISM),PABSTT,
     &                RANT1(IAM),RANT2(IAM),XANT1(IAM),XANT2(IAM),
     &                PANT1,PANT2,PANT,PWALL1,PWALL2,PWALL,
     &                PIBW1,PIBW2,PIBW,PERR
      COMMON /W1XDAT/ XA(NXQ),XAM(NXTM)
      PARAMETER (NZPMP1=NZPM+1)
      REAL*4 GDATA1,GDATA2,GDATA3,GX,GXM,GZ,GDATAZ
      COMMON /W1GDAT/ GDATA1(NXTM),GDATA2(NXTM),GDATA3(NXTM),
     &                GX(NXTM),GXM(NXTM),GZ(NZPMP1),GDATAZ(NZPMP1)
      COMMON /W1WORK/ TEMP(NXTM,NZPM),NXPRNT(NXTM)
      COMMON /W1ANT1/ AJYL(IAM),AJYH(IAM),AJZL(IAM),AJZH(IAM),
     &                ALYL(IAM),ALYH(IAM),APYL(IAM),APYH(IAM)
C
      REAL*4 GA,GB,GAMIN,GAMAX,GMIN,GMAX,SCAL
C
      IF(NGRAPH.EQ.0) RETURN
C
      RNORM=1.D0/SQRT(PANT)
      RNORM2=RNORM*RNORM
C
      CALL PAGES
      CALL SETMKS(0,0.1)
      CALL SETCHS(0.3,0.)
      CALL SETLIN(0,0,4)
      GA=RA
      GB=RB
      CALL MOVE( 2.5,17.7)
      CALL TEXT('BX,BY,BZ',8)
      CALL MOVE(15.0,17.7)
      CALL TEXT('AX,AZ,PHI',9)
C
      DO 1010 NX=1,NXP
         GXM   (NX)=XAM(NX)
         GDATA1(NX)= ABS(CBF(NX,1))*RNORM
         GDATA2(NX)=REAL(CBF(NX,1))*RNORM
         GDATA3(NX)=IMAG(CBF(NX,1))*RNORM
 1010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,12.,17.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 1020 NX=1,NXP
         GDATA1(NX)= ABS(CBF(NX,2))*RNORM
         GDATA2(NX)=REAL(CBF(NX,2))*RNORM
         GDATA3(NX)=IMAG(CBF(NX,2))*RNORM
 1020 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,6.5,12.,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 1030 NX=1,NXP
         GDATA1(NX)= ABS(CBF(NX,3))*RNORM
         GDATA2(NX)=REAL(CBF(NX,3))*RNORM
         GDATA3(NX)=IMAG(CBF(NX,3))*RNORM
 1030 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,1.,6.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 2010 NX=1,NXP
         GDATA1(NX)= ABS(CAF(NX,1))*RNORM
         GDATA2(NX)=REAL(CAF(NX,1))*RNORM
         GDATA3(NX)=IMAG(CAF(NX,1))*RNORM
 2010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,12.,17.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 2020 NX=1,NXP
         GDATA1(NX)= ABS(CAF(NX,3))*RNORM
         GDATA2(NX)=REAL(CAF(NX,3))*RNORM
         GDATA3(NX)=IMAG(CAF(NX,3))*RNORM
 2020 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,6.5,12.,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 2030 NX=1,NXP
         GDATA1(NX)= ABS(CAF(NX,4))*RNORM
         GDATA2(NX)=REAL(CAF(NX,4))*RNORM
         GDATA3(NX)=IMAG(CAF(NX,4))*RNORM
 2030 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,1.,6.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      CALL PAGEE
      RETURN
      END
C
      SUBROUTINE W1GRUF(NGRAPH)
C
      IMPLICIT COMPLEX*16(C),REAL*8(A-B,D-H,O-Z)
C
      INCLUDE 'w1comm.f'
      PARAMETER (NZPM=2**NZLM)
      PARAMETER (NXTM=NXPM+2*NXVM,NXM=NXPM*6+10,NXQ=NXPM+1)
      COMMON /W1PRM1/ NXP,NXV,NXT,ISMAX,IAMAX
      COMMON /W1PRM2/ RF,RKZ,BB,RR,RA,RD,RB,WALLR
      COMMON /W1CNST/ AEE,AME,AMM,VC,EPS0,AMYU0,PI
      COMMON /W1BAH1/ CEF(NXTM,3),CBF(NXTM,3),CAF(NXTM,4)
      COMMON /W1BAH2/ RHL(NXTM,7),CJF(NXPM,ISM,7),FHL(NXPM,ISM,2)
      COMMON /W1BAH3/ AHLT(ISM,4),AHL(NXPM,ISM,4)
      COMMON /W1PWR1/ PABSX(NXPM,ISM),FLUXX(NXTM),PABSXZ(ISM),PABSTT,
     &                RANT1(IAM),RANT2(IAM),XANT1(IAM),XANT2(IAM),
     &                PANT1,PANT2,PANT,PWALL1,PWALL2,PWALL,
     &                PIBW1,PIBW2,PIBW,PERR
      COMMON /W1XDAT/ XA(NXQ),XAM(NXTM)
      PARAMETER (NZPMP1=NZPM+1)
      REAL*4 GDATA1,GDATA2,GDATA3,GX,GXM,GZ,GDATAZ
      COMMON /W1GDAT/ GDATA1(NXTM),GDATA2(NXTM),GDATA3(NXTM),
     &                GX(NXTM),GXM(NXTM),GZ(NZPMP1),GDATAZ(NZPMP1)
      COMMON /W1WORK/ TEMP(NXTM,NZPM),NXPRNT(NXTM)
      COMMON /W1ANT1/ AJYL(IAM),AJYH(IAM),AJZL(IAM),AJZH(IAM),
     &                ALYL(IAM),ALYH(IAM),APYL(IAM),APYH(IAM)
C
      REAL*4 GA,GB,GAMIN,GAMAX,GMIN,GMAX,SCAL
      REAL*4 GAMIN1,GAMIN2,GAMIN3,GAMAX1,GAMAX2,GAMAX3
C
      IF(NGRAPH.EQ.0) RETURN
C
      RNORM=1.D0/SQRT(PANT)
      RNORM2=RNORM*RNORM
C
      CALL PAGES
      CALL SETMKS(0,0.1)
      CALL SETCHS(0.3,0.)
      CALL SETLIN(0,2,4)
      GA=RA
      GB=RB
      CALL MOVE( 2.5,17.7)
      CALL TEXT('QH,E.B,EPARA,LAMBDA',19)
      CALL MOVE(15.0,17.7)
      CALL TEXT('FR,FNR,JE,JET',13)
C
C
      DO 1020 NX=1,NXP
         GXM   (NX)=XAM(NX)
         GDATA1(NX)=RHL(NX,2)*RNORM2
 1020 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      GAMAX=MAX(GAMAX,ABS(GAMIN))
      CALL GQSCAL(-GAMAX,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,13.5,17.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,2,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,4)
C
      DO 1030 NX=1,NXP
         GDATA1(NX)=RHL(NX,3)*RNORM2
 1030 CONTINUE
      CALL GMNMX1(GDATA1,5,NXP-4,1,GAMIN,GAMAX)
      GAMAX=MAX(GAMAX,ABS(GAMIN))
      CALL GQSCAL(-GAMAX,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,9.5,13.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
C     CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,2,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,4)
C
      DO 2010 NX=1,NXP
         GDATA1(NX)=(AHL(NX,1,3)+AHL(NX,1,4))*RNORM2
         GDATA2(NX)=AHL(NX,1,3)*RNORM2
         GDATA3(NX)=AHL(NX,1,4)*RNORM2
 2010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
      CALL GMNMX1(GDATA2,1,NXP,1,GAMIN2,GAMAX2)
      CALL GMNMX1(GDATA3,1,NXP,1,GAMIN3,GAMAX3)
      GAMIN=MIN(GAMIN1,GAMIN2,GAMIN3)
      GAMAX=MAX(GAMAX1,GAMAX2,GAMAX3)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,1.5,5.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,2,7)
C     CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,2,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,4)
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
C
      GAMIN= 1.E32
      GAMAX=-1.E32
      DO 2021 IS=1,ISMAX
         DO 2020 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,1)*RNORM2
 2020    CONTINUE
         CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
         GAMIN=MIN(GAMIN,GAMIN1)
         GAMAX=MAX(GAMAX,GAMAX1)
 2021 CONTINUE
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,13.5,17.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      DO 2026 IS=1,ISMAX
         DO 2025 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,1)*RNORM2
 2025    CONTINUE
         CALL SETLIN(0,2,7-IS)
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,-IS,10,0)
 2026 CONTINUE
      CALL SETLIN(0,2,4)
C
      GAMIN= 1.E32
      GAMAX=-1.E32
      DO 2031 IS=1,ISMAX
         DO 2030 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,2)*RNORM2
 2030    CONTINUE
         CALL GMNMX1(GDATA1,5,NXP-4,1,GAMIN1,GAMAX1)
         GAMIN=MIN(GAMIN,GAMIN1)
         GAMAX=MAX(GAMAX,GAMAX1)
 2031 CONTINUE
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,9.5,13.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
C     CALL GVALUE(0.,REAL(RA),0.,0.,2)
      DO 2036 IS=1,ISMAX
         DO 2035 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,2)*RNORM2
 2035    CONTINUE
         CALL SETLIN(0,2,7-IS)
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,-IS,10,0)
 2036 CONTINUE
      CALL SETLIN(0,2,4)
C
C
      DO 3020 NX=1,NXP
         GDATA1(NX)=RHL(NX,6)*RNORM2
         GDATA2(NX)=RHL(NX,7)*RNORM2
 3020 CONTINUE
      CALL GMNMX1(GDATA1,5,NXP-4,1,GAMIN1,GAMAX1)
      CALL GMNMX1(GDATA2,5,NXP-4,1,GAMIN2,GAMAX2)
      GAMAX=MAX(GAMAX1,GAMAX2)
      GAMIN=MIN(GAMIN1,GAMIN2)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,5.5,9.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,2,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1,-7,10,0)
      CALL SETLIN(0,2,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,4)
C
      DO 3030 NX=1,NXP
         GDATA1(NX)=-RHL(NX,7)/RHL(NX,6)
C        IF(F.GT.1.D0) THEN  
C            GDATA1(NX)= 2.D0-1.D0/F
C         ELSEIF(F.LT.-1.D0) THEN
C           GDATA1(NX)=-2.D0-1.D0/F
C        ELSE
C           GDATA1(NX)= F
C        ENDIF
 3030 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      SCAL=0.25
      CALL GDEFIN(2.5,12.5,1.5,5.5,-GB,GB,-0.5,1.5)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL SETLIN(1,2,4)
      CALL GSCALE(0.,0.,1.,13.*SCAL,0.1,0)
      CALL SETLIN(0,2,4)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,2,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,4)
C
      DO 4010 NX=1,NXP
         GDATA1(NX)=(AHL(NX,1,1)+AHL(NX,1,2))*RNORM2
         GDATA2(NX)=AHL(NX,1,1)*RNORM2
         GDATA3(NX)=AHL(NX,1,2)*RNORM2
 4010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
      CALL GMNMX1(GDATA2,1,NXP,1,GAMIN2,GAMAX2)
      CALL GMNMX1(GDATA3,1,NXP,1,GAMIN3,GAMAX3)
      GAMIN=MIN(GAMIN1,GAMIN2,GAMIN3)
      GAMAX=MAX(GAMAX1,GAMAX2,GAMAX3)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,5.5,9.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.2,0.,2*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
C     CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,2,7)
C     CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,2,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,2,4)
C
C
      CALL PAGEE
      RETURN
      END
C
C     ****** 1-D GRAPHIC PARAMETER ******
C
C     ****** 1-D GRAPHIC ROUTINE (HELICITY) ******
C
      SUBROUTINE W1GR1H(NGRAPH)
C
      IMPLICIT COMPLEX*16(C),REAL*8(A-B,D-H,O-Z)
C
      INCLUDE 'w1comm.f'
      PARAMETER (NZPM=2**NZLM)
      PARAMETER (NXTM=NXPM+2*NXVM,NXM=NXPM*6+10,NXQ=NXPM+1)
      COMMON /W1PRM1/ NXP,NXV,NXT,ISMAX,IAMAX
      COMMON /W1PRM2/ RF,RKZ,BB,RR,RA,RD,RB,WALLR
      COMMON /W1CNST/ AEE,AME,AMM,VC,EPS0,AMYU0,PI
      COMMON /W1BAH1/ CEF(NXTM,3),CBF(NXTM,3),CAF(NXTM,4)
      COMMON /W1BAH2/ RHL(NXTM,7),CJF(NXPM,ISM,7),FHL(NXPM,ISM,2)
      COMMON /W1BAH3/ AHLT(ISM,4),AHL(NXPM,ISM,4)
      COMMON /W1PWR1/ PABSX(NXPM,ISM),FLUXX(NXTM),PABSXZ(ISM),PABSTT,
     &                RANT1(IAM),RANT2(IAM),XANT1(IAM),XANT2(IAM),
     &                PANT1,PANT2,PANT,PWALL1,PWALL2,PWALL,
     &                PIBW1,PIBW2,PIBW,PERR
      COMMON /W1XDAT/ XA(NXQ),XAM(NXTM)
      PARAMETER (NZPMP1=NZPM+1)
      REAL*4 GDATA1,GDATA2,GDATA3,GX,GXM,GZ,GDATAZ
      COMMON /W1GDAT/ GDATA1(NXTM),GDATA2(NXTM),GDATA3(NXTM),
     &                GX(NXTM),GXM(NXTM),GZ(NZPMP1),GDATAZ(NZPMP1)
      COMMON /W1WORK/ TEMP(NXTM,NZPM),NXPRNT(NXTM)
      COMMON /W1ANT1/ AJYL(IAM),AJYH(IAM),AJZL(IAM),AJZH(IAM),
     &                ALYL(IAM),ALYH(IAM),APYL(IAM),APYH(IAM)
C
      REAL*4 GA,GB,GAMIN,GAMAX,GMIN,GMAX,SCAL
      REAL*4 GAMIN1,GAMIN2,GAMIN3,GAMAX1,GAMAX2,GAMAX3
C
      IF(NGRAPH.EQ.0) RETURN
C
      RNORM=1.D0/SQRT(PANT)
      RNORM2=RNORM*RNORM
C
      CALL PAGES
      CALL SETMKS(0,0.1)
      CALL SETCHS(0.3,0.)
      CALL SETLIN(0,0,4)
      GA=RA
      GB=RB
      CALL MOVE( 2.5,17.7)
      CALL TEXT('FTOT,HEL,RAT',11)
      CALL MOVE(15.0,17.7)
      CALL TEXT('JE,JR,JNR',9)
C
      DO 1010 NX=1,NXP
         GXM   (NX)=XAM(NX)
         GDATA1(NX)=RHL(NX,4)*RNORM2
         GDATA2(NX)=RHL(NX,5)*RNORM2
 1010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
      CALL GMNMX1(GDATA2,1,NXP,1,GAMIN2,GAMAX2)
      GAMAX=MAX(GAMAX1,GAMAX2)
      GAMIN=MIN(GAMIN1,GAMIN2)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,12.,17.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1, -3, 10,0)
      CALL SETLIN(0,0,4)
C
      DO 1020 NX=1,NXP
         GDATA1(NX)=RHL(NX,6)*RNORM2
         GDATA2(NX)=RHL(NX,7)*RNORM2
 1020 CONTINUE
      CALL GMNMX1(GDATA1,2,NXP-1,1,GAMIN1,GAMAX1)
      CALL GMNMX1(GDATA2,2,NXP-1,1,GAMIN2,GAMAX2)
      GAMAX=MAX(GAMAX1,GAMAX2)
      GAMIN=MIN(GAMIN1,GAMIN2)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,6.5,12.,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1, -3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 1030 NX=1,NXP
         GDATA1(NX)=-RHL(NX,7)/RHL(NX,6)
C        IF(F.GT.1.D0) THEN  
C            GDATA1(NX)= 2.D0-1.D0/F
C         ELSEIF(F.LT.-1.D0) THEN
C           GDATA1(NX)=-2.D0-1.D0/F
C        ELSE
C           GDATA1(NX)= F
C        ENDIF
 1030 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      SCAL=0.25
      CALL GDEFIN(2.5,12.5,1.,6.5,-GB,GB,-1.999,1.999)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,4)
C
      DO 2010 NX=1,NXP
         GDATA1(NX)=(AHL(NX,1,1)+AHL(NX,1,2))*RNORM2
         GDATA2(NX)=AHL(NX,1,1)*RNORM2
         GDATA3(NX)=AHL(NX,1,2)*RNORM2
 2010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
      CALL GMNMX1(GDATA2,1,NXP,1,GAMIN2,GAMAX2)
      CALL GMNMX1(GDATA3,1,NXP,1,GAMIN3,GAMAX3)
      GAMIN=MIN(GAMIN1,GAMIN2,GAMIN3)
      GAMAX=MAX(GAMAX1,GAMAX2,GAMAX3)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,12.,17.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      GAMIN= 1.E32
      GAMAX=-1.E32
      DO 2021 IS=1,ISMAX
         DO 2020 NX=1,NXP
            GDATA1(NX)=AHL(NX,IS,1)*RNORM2
 2020    CONTINUE
         CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
         GAMIN=MIN(GAMIN,GAMIN1)
         GAMAX=MAX(GAMAX,GAMAX1)
 2021 CONTINUE
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,6.5,12.,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      DO 2026 IS=1,ISMAX
         DO 2025 NX=1,NXP
            GDATA1(NX)=AHL(NX,IS,1)*RNORM2
 2025    CONTINUE
         CALL SETLIN(0,0,7-IS)
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,-IS,10,0)
 2026 CONTINUE
      CALL SETLIN(0,0,4)
C
      GAMIN= 1.E32
      GAMAX=-1.E32
      DO 2031 IS=1,ISMAX
         DO 2030 NX=1,NXP
            GDATA1(NX)=AHL(NX,IS,2)*RNORM2
 2030    CONTINUE
         CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
         GAMIN=MIN(GAMIN,GAMIN1)
         GAMAX=MAX(GAMAX,GAMAX1)
 2031 CONTINUE
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,1.,6.5,-GB,GB,GMIN,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      DO 2036 IS=1,ISMAX
         DO 2035 NX=1,NXP
            GDATA1(NX)=AHL(NX,IS,2)*RNORM2
 2035    CONTINUE
         CALL SETLIN(0,0,7-IS)
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,-IS,10,0)
 2036 CONTINUE
      CALL SETLIN(0,0,4)
C
      CALL PAGEE
      RETURN
      END
C
C     OPTIMUM NUM LENGTH FOR GVALUE
C
      FUNCTION NGVLEN(GSTEP)
C
      NGX = -LOG10(2*GSTEP*0.11)
      IF(NGX.LT.0) NGX=0
      IF(NGX.GT.5) NGX=-1
      NGVLEN=NGX
      RETURN
      END
C
      SUBROUTINE W1GPRX
C
      IMPLICIT COMPLEX*16(C),REAL*8(A-B,D-H,O-Z)
C
      INCLUDE 'w1comm.f'
      PARAMETER (NZPM=2**NZLM)
      PARAMETER (NXTM=NXPM+2*NXVM,NXM=NXPM*6+10,NXQ=NXPM+1)
      COMMON /W1PRM1/ NXP,NXV,NXT,ISMAX,IAMAX
      COMMON /W1PRM2/ RF,RKZ,BB,RR,RA,RD,RB,WALLR
      COMMON /W1PRM3/ PA(ISM),PZ(ISM),PN(ISM),PTPP(ISM),PTPR(ISM),
     &                PNS(ISM),PTS(ISM),PU(ISM),PZCL(ISM)
      COMMON /W1PWR1/ PABSX(NXPM,ISM),FLUXX(NXTM),PABSXZ(ISM),PABSTT,
     &                RANT1(IAM),RANT2(IAM),XANT1(IAM),XANT2(IAM),
     &                PANT1,PANT2,PANT,PWALL1,PWALL2,PWALL,
     &                PIBW1,PIBW2,PIBW,PERR
      COMMON /W1XDAT/ XA(NXQ),XAM(NXTM)
      COMMON /W1ZDAT/ CJ1(NZPM),CJ2(NZPM),CJ3(NZPM),CJ4(NZPM),
     &                ZA(NZPM),AKZ(NZPM),NZANT1(IAM),NZANT2(IAM),NANT
      COMMON /W1ANT1/ AJYL(IAM),AJYH(IAM),AJZL(IAM),AJZH(IAM),
     &                ALYL(IAM),ALYH(IAM),APYL(IAM),APYH(IAM)
      COMMON /W1QCTL/ XDMAX,DXD,NDMAX,NHARM,IHARM(ISM),MATL,NMODEL
      COMMON /W1CDDT/ AJCDX(NXPM),AJCDK(NZPM),AJCDT,ZEFF,WVYSIZ,ICDTYP
      COMMON /W1BAH3/ AHLT(ISM,4),AHL(NXPM,ISM,4)
C
      RNORM2=1.D0/PANT
C
      CALL SETLIN(0,0,7)
      CALL MOVE(14.,12.0)
      CALL TEXT('IR   =',6)
      DO 1210 IS=1,MIN(ISMAX,4)
         CALL SETLIN(0,0,7-IS)
         CALL NUMBD(AHLT(IS,1)*RNORM2,'(F8.5)',8)
 1210 CONTINUE
      CALL SETLIN(0,0,7)
      CALL MOVE(14.,11.5)
      CALL TEXT('INR  =',6)
      DO 1220 IS=1,MIN(ISMAX,4)
         CALL SETLIN(0,0,7-IS)
         CALL NUMBD(AHLT(IS,2)*RNORM2,'(F8.5)',8)
 1220 CONTINUE
      CALL SETLIN(0,0,7)
      CALL MOVE(14.,11.0)
      CALL TEXT('ITOT =',6)
      DO 1230 IS=1,MIN(ISMAX,4)
         CALL SETLIN(0,0,7-IS)
         CALL NUMBD((AHLT(IS,1)+AHLT(IS,2))*RNORM2,'(F8.5)',8)
 1230 CONTINUE
C
      CALL SETLIN(0,0,7)
      CALL MOVE(14.,10.3)
      CALL TEXT('IR  T=',6)
      DO 1240 IS=1,MIN(ISMAX,4)
         CALL SETLIN(0,0,7-IS)
         CALL NUMBD(AHLT(IS,3)*RNORM2,'(F8.5)',8)
 1240 CONTINUE
      CALL SETLIN(0,0,7)
      CALL MOVE(14., 9.8)
      CALL TEXT('INR T=',6)
      DO 1250 IS=1,MIN(ISMAX,4)
         CALL SETLIN(0,0,7-IS)
         CALL NUMBD(AHLT(IS,4)*RNORM2,'(F8.5)',8)
 1250 CONTINUE
      CALL SETLIN(0,0,7)
      CALL MOVE(14., 9.3)
      CALL TEXT('ITOTT=',6)
      DO 1260 IS=1,MIN(ISMAX,4)
         CALL SETLIN(0,0,7-IS)
         CALL NUMBD((AHLT(IS,3)+AHLT(IS,4))*RNORM2,'(F8.5)',8)
 1260 CONTINUE
      CALL SETLIN(0,2,4)
C
      RETURN
      END
C
C     ****** 1-D GRAPHIC ROUTINE ******
C
      SUBROUTINE W1GR1D(NGRAPH)
C
      IMPLICIT COMPLEX*16(C),REAL*8(A-B,D-H,O-Z)
C
      INCLUDE 'w1comm.f'
      PARAMETER (NZPM=2**NZLM)
      PARAMETER (NXTM=NXPM+2*NXVM,NXM=NXPM*6+10,NXQ=NXPM+1)
      COMMON /W1PRM1/ NXP,NXV,NXT,ISMAX,IAMAX
      COMMON /W1PRM2/ RF,RKZ,BB,RR,RA,RD,RB,WALLR
      COMMON /W1PRM3/ PA(ISM),PZ(ISM),PN(ISM),PTPP(ISM),PTPR(ISM),
     &                PNS(ISM),PTS(ISM),PU(ISM),PZCL(ISM)
      COMMON /W1PRM4/ RZ,DZ,NZP
      COMMON /W1EF2D/ CE2DA(NZPM,NXTM,3)
      COMMON /W1PWR1/ PABSX(NXPM,ISM),FLUXX(NXTM),PABSXZ(ISM),PABSTT,
     &                RANT1(IAM),RANT2(IAM),XANT1(IAM),XANT2(IAM),
     &                PANT1,PANT2,PANT,PWALL1,PWALL2,PWALL,
     &                PIBW1,PIBW2,PIBW,PERR
      COMMON /W1XDAT/ XA(NXQ),XAM(NXTM)
      COMMON /W1ZDAT/ CJ1(NZPM),CJ2(NZPM),CJ3(NZPM),CJ4(NZPM),
     &                ZA(NZPM),AKZ(NZPM),NZANT1(IAM),NZANT2(IAM),NANT
      PARAMETER (NZPMP1=NZPM+1)
      REAL*4 GDATA1,GDATA2,GDATA3,GX,GXM,GZ,GDATAZ
      COMMON /W1GDAT/ GDATA1(NXTM),GDATA2(NXTM),GDATA3(NXTM),
     &                GX(NXTM),GXM(NXTM),GZ(NZPMP1),GDATAZ(NZPMP1)
      COMMON /W1WORK/ TEMP(NXTM,NZPM),NXPRNT(NXTM)
      COMMON /W1ANT1/ AJYL(IAM),AJYH(IAM),AJZL(IAM),AJZH(IAM),
     &                ALYL(IAM),ALYH(IAM),APYL(IAM),APYH(IAM)
      COMMON /W1QCTL/ XDMAX,DXD,NDMAX,NHARM,IHARM(ISM),MATL,NMODEL
      COMMON /W1CDDT/ AJCDX(NXPM),AJCDK(NZPM),AJCDT,ZEFF,WVYSIZ,ICDTYP
C
      REAL*4 GA,GB,GAMIN,GAMAX,GMIN,GMAX,SCAL
      REAL*4 PGAMIN,PGAMAX,PGMIN,PGMAX,SGAMAX,PSCAL
C
      IF(NGRAPH.EQ.0) RETURN
C
      IF(ABS(PANT).LE.0.D0) THEN
         RNORM=1.D0
      ELSE
         RNORM=1.D0/SQRT(ABS(PANT))
      ENDIF
      RNORM2=RNORM*RNORM
C
    1 IF(NZP.EQ.1) THEN
         NZ=1
      ELSE
  100    CONTINUE
         WRITE(6,*) '## GRAPH INPUT : NZ  (0 : QUIT GRAPHIC)'
         READ(5,*,END=9990) NZ
         IF(NZ.GT.NZP) GOTO 100
         IF(NZ.LE.0) RETURN
      ENDIF
C
      CALL PAGES
      CALL SETMKS(0,0.1)
      CALL SETCHS(0.3,0.)
      CALL SETLIN(0,0,4)
      CALL MOVE( 2.5,17.7)
      CALL TEXT('EX,EY,EZ',8)
C
      GA=RA
      GB=RB
      DO 1010 NX=1,NXT
      NN        =NXPRNT(NX)
      GX    (NX)=XAM(NN)
      GXM   (NX)=XAM(NX)
      GDATA1(NX)= ABS(CE2DA(NZ,NN,1))*RNORM
      GDATA2(NX)=REAL(CE2DA(NZ,NN,1))*RNORM
      GDATA3(NX)=IMAG(CE2DA(NZ,NN,1))*RNORM
 1010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXT,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,12.,17.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GX,GDATA1,1,NXT,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GX,GDATA2,1,NXT,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GX,GDATA3,1,NXT,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 1020 NX=1,NXT
      NN        =NXPRNT(NX)
      GDATA1(NX)= ABS(CE2DA(NZ,NN,2))*RNORM
      GDATA2(NX)=REAL(CE2DA(NZ,NN,2))*RNORM
      GDATA3(NX)=IMAG(CE2DA(NZ,NN,2))*RNORM
 1020 CONTINUE
      CALL GMNMX1(GDATA1,1,NXT,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,6.5,12.,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GX,GDATA1,1,NXT,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GX,GDATA2,1,NXT,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GX,GDATA3,1,NXT,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      DO 1025 NX=1,NXT
      NN        =NXPRNT(NX)
      GDATA1(NX)= ABS(CE2DA(NZ,NN,3))*RNORM
      GDATA2(NX)=REAL(CE2DA(NZ,NN,3))*RNORM
      GDATA3(NX)=IMAG(CE2DA(NZ,NN,3))*RNORM
 1025 CONTINUE
      CALL GMNMX1(GDATA1,1,NXT,1,GAMIN,GAMAX)
      CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,1.,6.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GX,GDATA1,1,NXT,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GX,GDATA2,1,NXT,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GX,GDATA3,1,NXT,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      PGAMIN=0.0
      PGAMAX=0.0
      DO 1029 IS=1,ISMAX
         DO 1028 NX=1,NXP
            GDATA1(NX)=PABSX(NX,IS)*RNORM2
 1028    CONTINUE
         CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
         PGAMIN=MIN(PGAMIN,GAMIN)
         PGAMAX=MAX(PGAMAX,GAMAX)
 1029 CONTINUE
      PGAMAX=MAX(ABS(PGAMAX),ABS(PGAMIN))
      CALL GQSCAL(0.,PGAMAX,PGMIN,PGMAX,PSCAL)
C
      DO 1030 NX=1,NXP
         GDATA1(NX)=AJCDX(NX)*RNORM2
 1030 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      IF(ABS(GAMAX).GE.ABS(GAMIN)) THEN
         SGAMAX=GAMAX
      ELSE
         SGAMAX=GAMIN
      ENDIF
      
      IF(MOD(NGRAPH,4).NE.2.AND.MOD(NGRAPH,4).NE.3) THEN
         CALL GQSCAL(GAMIN,GAMAX,GMIN,GMAX,SCAL)
         CALL GDEFIN(15.0,25.0,6.5,12.0,-GB,GB,GMIN,GMAX)
         CALL GFRAME
         CALL GSCALE(0.,0.1,0.,0.,0.1,9)
         CALL GSCALE(0.,0.,0.,SCAL,0.1,9)
         CALL GSCALE(0.,100.,0.,0.,0.2,9)
         CALL GSCALE(-GA,2.*GA,0.,20.*SCAL,0.1,0)
         CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
         CALL SETLIN(0,0,7)
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,0,0,0)
         CALL SETLIN(0,0,4)
      ENDIF
C
      IF(MOD(NGRAPH,4).EQ.3) THEN
         CALL GDEFIN(15.0,25.0,1.0,12.0,-GB,GB,-0.1*PGMAX,PGMAX)
      ELSE
         CALL GDEFIN(15.0,25.0,1.0,6.5,-GB,GB,-0.1*PGMAX,PGMAX)
      ENDIF
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,0.,0.1,9)
      CALL GSCALE(0.,0.,0.,PSCAL,0.1,1)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,20.*PSCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*PSCAL,NGVLEN(4*PSCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      DO 1040 IS=1,ISMAX
         CALL SETLIN(0,0,7-IS)
         DO 1039 NX=1,NXP
            GDATA1(NX)=PABSX(NX,IS)*RNORM2
 1039    CONTINUE
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,-IS,10,0)
 1040 CONTINUE
      CALL SETLIN(0,0,4)
C
      IF(NMODEL.EQ.5.OR.NMODEL.EQ.3.OR.NMODEL.EQ.1) THEN
         DO 1130 NX=1,NXT
            NN        =NXPRNT(NX)
            GDATA1(NX)=FLUXX(NN)*RNORM2
 1130    CONTINUE
         CALL GMNMX1(GDATA1,1,NXT,1,GAMIN,GAMAX)
         IF(ABS(GAMIN).GE.ABS(GAMAX)) THEN
            DO 1131 NX=1,NXT
               GDATA1(NX)=-GDATA1(NX)
 1131       CONTINUE
         GAMAX=-GAMIN
         ENDIF
         CALL GQSCAL(0.,GAMAX*1.02,GMIN,GMAX,SCAL)
         IF(MOD(NGRAPH,4).EQ.3) THEN
            CALL GDEFIN(15.0,25.0,1.0,12.0,-GB,GB,-0.1*GMAX,GMAX)
         ELSE
            CALL GDEFIN(15.0,25.0,1.0,6.5,-GB,GB,-0.1*GMAX,GMAX)
         ENDIF
         CALL GSCALE(0.,0.,0.,SCAL,0.1,5)
         CALL SETLIN(0,0,7)
         CALL GPLOTP(GX,GDATA1,1,NXT,1,0,0,0)
      ENDIF
C
      CALL W1GPRM(NZ,NZP)
C
      CALL PAGEE
      IF(NZP.GT.1) GOTO 1
      RETURN
C
 9990 CONTINUE
      RETURN
      END
C
C     ****** 1-D GRAPHIC ROUTINE (HELICITY) ******
C
      SUBROUTINE W1GR1F(NGRAPH)
C
      IMPLICIT COMPLEX*16(C),REAL*8(A-B,D-H,O-Z)
C
      INCLUDE 'w1comm.f'
      PARAMETER (NZPM=2**NZLM)
      PARAMETER (NXTM=NXPM+2*NXVM,NXM=NXPM*6+10,NXQ=NXPM+1)
      COMMON /W1PRM1/ NXP,NXV,NXT,ISMAX,IAMAX
      COMMON /W1PRM2/ RF,RKZ,BB,RR,RA,RD,RB,WALLR
      COMMON /W1CNST/ AEE,AME,AMM,VC,EPS0,AMYU0,PI
      COMMON /W1BAH1/ CEF(NXTM,3),CBF(NXTM,3),CAF(NXTM,4)
      COMMON /W1BAH2/ RHL(NXTM,7),CJF(NXPM,ISM,7),FHL(NXPM,ISM,2)
      COMMON /W1BAH3/ AHLT(ISM,4),AHL(NXPM,ISM,4)
      COMMON /W1PWR1/ PABSX(NXPM,ISM),FLUXX(NXTM),PABSXZ(ISM),PABSTT,
     &                RANT1(IAM),RANT2(IAM),XANT1(IAM),XANT2(IAM),
     &                PANT1,PANT2,PANT,PWALL1,PWALL2,PWALL,
     &                PIBW1,PIBW2,PIBW,PERR
      COMMON /W1XDAT/ XA(NXQ),XAM(NXTM)
      PARAMETER (NZPMP1=NZPM+1)
      REAL*4 GDATA1,GDATA2,GDATA3,GX,GXM,GZ,GDATAZ
      COMMON /W1GDAT/ GDATA1(NXTM),GDATA2(NXTM),GDATA3(NXTM),
     &                GX(NXTM),GXM(NXTM),GZ(NZPMP1),GDATAZ(NZPMP1)
      COMMON /W1WORK/ TEMP(NXTM,NZPM),NXPRNT(NXTM)
      COMMON /W1ANT1/ AJYL(IAM),AJYH(IAM),AJZL(IAM),AJZH(IAM),
     &                ALYL(IAM),ALYH(IAM),APYL(IAM),APYH(IAM)
C
      REAL*4 GA,GB,GAMIN,GAMAX,GMIN,GMAX,SCAL
      REAL*4 GAMIN1,GAMIN2,GAMIN3,GAMAX1,GAMAX2,GAMAX3
C
      IF(NGRAPH.EQ.0) RETURN
C
      RNORM=1.D0/SQRT(PANT)
      RNORM2=RNORM*RNORM
C
      CALL PAGES
      CALL SETMKS(0,0.1)
      CALL SETCHS(0.3,0.)
      CALL SETLIN(0,0,4)
      GA=RA
      GB=RB
      CALL MOVE( 2.5,17.7)
      CALL TEXT('A.B,QH,E.B',10)
      CALL MOVE(15.0,17.7)
      CALL TEXT('FE,FR,FNR',9)
C
      DO 1010 NX=1,NXP
         GXM   (NX)=XAM(NX)
         GDATA1(NX)=RHL(NX,1)*RNORM2
 1010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      GAMAX=MAX(GAMAX,ABS(GAMIN))
      CALL GQSCAL(-GAMAX,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,12.,17.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,4)
C
      DO 1020 NX=1,NXP
         GDATA1(NX)=RHL(NX,2)*RNORM2
 1020 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN,GAMAX)
      GAMAX=MAX(GAMAX,ABS(GAMIN))
      CALL GQSCAL(-GAMAX,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,6.5,12.,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,4)
C
      DO 1030 NX=1,NXP
         GDATA1(NX)=RHL(NX,3)*RNORM2
 1030 CONTINUE
      CALL GMNMX1(GDATA1,2,NXP-1,1,GAMIN,GAMAX)
      GAMAX=MAX(GAMAX,ABS(GAMIN))
      CALL GQSCAL(-GAMAX,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(2.5,12.5,1.,6.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,4)
C
      DO 2010 NX=1,NXP
         GDATA1(NX)=(FHL(NX,1,1)+FHL(NX,1,2))*RNORM2
         GDATA2(NX)=FHL(NX,1,1)*RNORM2
         GDATA3(NX)=FHL(NX,1,2)*RNORM2
 2010 CONTINUE
      CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
      CALL GMNMX1(GDATA2,1,NXP,1,GAMIN2,GAMAX2)
      CALL GMNMX1(GDATA3,1,NXP,1,GAMIN3,GAMAX3)
      GAMIN=MIN(GAMIN1,GAMIN2,GAMIN3)
      GAMAX=MAX(GAMAX1,GAMAX2,GAMAX3,ABS(GAMIN))
      CALL GQSCAL(0.0,GAMAX,GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,12.,17.5,-GB,GB,-0.1*GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL SETLIN(0,0,7)
      CALL GPLOTP(GXM,GDATA1,1,NXP,1, 0, 0,0)
      CALL SETLIN(0,0,6)
      CALL GPLOTP(GXM,GDATA2,1,NXP,1,-7,10,0)
      CALL SETLIN(0,0,5)
      CALL GPLOTP(GXM,GDATA3,1,NXP,1,-3,10,0)
      CALL SETLIN(0,0,4)
C
      GAMIN= 1.E32
      GAMAX=-1.E32
      DO 2021 IS=1,ISMAX
         DO 2020 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,1)*RNORM2
 2020    CONTINUE
         CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
         GAMIN=MIN(GAMIN,GAMIN1)
         GAMAX=MAX(GAMAX,GAMAX1)
 2021 CONTINUE
      CALL GQSCAL(0.0,MAX(GAMAX,ABS(GAMIN)),GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,6.5,12.,-GB,GB,-0.1*GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      DO 2026 IS=1,ISMAX
         DO 2025 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,1)*RNORM2
 2025    CONTINUE
         CALL SETLIN(0,0,7-IS)
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,-IS,10,0)
 2026 CONTINUE
      CALL SETLIN(0,0,4)
C
      GAMIN= 1.E32
      GAMAX=-1.E32
      DO 2031 IS=1,ISMAX
         DO 2030 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,2)*RNORM2
 2030    CONTINUE
         CALL GMNMX1(GDATA1,1,NXP,1,GAMIN1,GAMAX1)
         GAMIN=MIN(GAMIN,GAMIN1)
         GAMAX=MAX(GAMAX,GAMAX1)
 2031 CONTINUE
      CALL GQSCAL(0.0,MAX(GAMAX,ABS(GAMIN)),GMIN,GMAX,SCAL)
      CALL GDEFIN(15.0,25.0,1.,6.5,-GB,GB,-GMAX,GMAX)
      CALL GFRAME
      CALL GSCALE(0.,0.1,0.,2.*SCAL,0.1,9)
      CALL GSCALE(0.,100.,0.,0.,0.2,9)
      CALL GSCALE(-GA,2.*GA,0.,13.*SCAL,0.1,0)
      CALL GVALUE(0.,0.,0.,4*SCAL,NGVLEN(4*SCAL))
      CALL GVALUE(0.,REAL(RA),0.,0.,2)
      DO 2036 IS=1,ISMAX
         DO 2035 NX=1,NXP
            GDATA1(NX)=FHL(NX,IS,2)*RNORM2
 2035    CONTINUE
         CALL SETLIN(0,0,7-IS)
         CALL GPLOTP(GXM,GDATA1,1,NXP,1,-IS,10,0)
 2036 CONTINUE
      CALL SETLIN(0,0,4)
C
      CALL PAGEE
      RETURN
      END

